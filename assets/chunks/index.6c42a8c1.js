import{d as j,j as b,a6 as S,O as w,H as i,a4 as v,ae as M,h as T,af as F,L as h}from"./framework.bf0d9ef3.js";import{o as x}from"./omit.dc85ab0f.js";import{I as E,C as I}from"./index.110d4343.js";import{E as N}from"./index.fc1c3505.js";import{C as P}from"./index.ba7e9b05.js";import{L as $}from"./index.6119473d.js";import{d as O,a as C,c as L}from"./type.8d15feec.js";const _={duration:{type:Number,default:3},onClose:{type:Function},onClick:{type:Function},icon:{type:Object},content:{type:[String,Object,Function]},key:{type:[String,Symbol,Number]},wrapperClass:{type:String},wrapperStyle:{type:Object},contentClass:{type:String},contentStyle:{type:Object}},R=j({props:_,setup(e,{expose:t}){let s=null;const n=()=>{s&&(clearTimeout(s),s=null)},c=()=>{n(),e.duration!==0&&(s=setTimeout(()=>{var a;(a=e.onClose)==null||a.call(e)},e.duration*1e3))};b(()=>{c()}),S(()=>{n()});const r=()=>{n()},l=()=>{n()},o=()=>{c()};return t({update:()=>{w(()=>{c()})}}),()=>i("div",{class:{"j-message-wrapper":!0,[e.wrapperClass||""]:!!e.wrapperClass},style:e.wrapperStyle,onClick:r,onMouseenter:l,onMousemove:l,onMouseleave:o},[i("div",{class:{"j-message":!0,[e.contentClass||""]:!!e.contentClass},style:e.contentStyle,onClick:()=>{var a;return(a=e.onClick)==null?void 0:a.call(e)}},[e.icon?i("span",{class:"j-message-icon"},[e.icon]):null,O(e.content)?e.content():e.content])])}});function V(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!v(e)}const k={duration:3};let g=null,u=null,p=1;const A=()=>new Promise(e=>{if(g)setTimeout(()=>{u!==null&&e(u)},0);else{g=document.createElement("div"),g.className="j-message-container",document.body.appendChild(g);const s=i(j({name:"MessageContainer",setup(){const n=T([]),c=new Map;u={add:({openOptions:l})=>{const o=n.value.findIndex(a=>a.options.key===l.key);if(o===-1){const a={options:{...k,...l}};n.value.push(a)}else n.value[o]={...n.value[o],options:{...n.value[o].options,...l}},c.get(n.value[o].options.key).update()},remove:l=>{var a,m;const o=n.value.findIndex(y=>y.options.key===l);if(o!==-1){const y=n.value[o];n.value.splice(o,1),(m=(a=y.options).onClose)==null||m.call(a)}},destroy:()=>{n.value.forEach(l=>{var o,a;(a=(o=l.options).onClose)==null||a.call(o)}),n.value=[]}},e(u);const r=(l,o)=>{var a,m;n.value.splice(o,1),(m=(a=l.options).onClose)==null||m.call(a)};return()=>{let l;return i("div",null,[i(F,{name:"j-message-wrapper-fade-in-down"},V(l=n.value.map((o,a)=>i(R,h(x(o.options,"onClose"),{onClose:()=>r(o,a),key:o.options.key,ref:m=>c.set(o.options.key,m)}),null)))?l:{default:()=>[l]})])}}}));M(s,g)}}),d=e=>v(e)||O(e)||L(e),G=e=>{const t=d(e)?{content:e,key:String(p++)}:{...e,key:e.key||String(p++)},s=new Promise(c=>{const{onClose:r}=t;t.onClose=()=>{r==null||r(),c()},A().then(l=>{l.add({openOptions:t})})}),n=()=>{u&&u.remove(t.key)};return n.then=(c,r)=>s.then(c,r),n},f={config:e=>{Object.assign(k,e)},open:G,info:(e,t)=>{const s=d(e)?{...C(t)?t:{},content:e}:e,n={icon:i(E,null,null),contentClass:s.contentClass?`j-message-info ${s.contentClass}`:"j-message-info"};return f.open({...s,...n})},success:(e,t)=>{const s=d(e)?{...C(t)?t:{},content:e}:e,n={icon:i(I,null,null),contentClass:s.contentClass?`j-message-success ${s.contentClass}`:"j-message-success"};return f.open({...s,...n})},warning:(e,t)=>{const s=d(e)?{...C(t)?t:{},content:e}:e,n={icon:i(N,null,null),contentClass:s.contentClass?`j-message-warning ${s.contentClass}`:"j-message-warning"};return f.open({...s,...n})},error:(e,t)=>{const s=d(e)?{...C(t)?t:{},content:e}:e,n={icon:i(P,null,null),contentClass:s.contentClass?`j-message-error ${s.contentClass}`:"j-message-error"};return f.open({...s,...n})},loading:(e,t)=>{const s=d(e)?{...C(t)?t:{},content:e}:e,n={icon:i($,{spin:!0},null),contentClass:s.contentClass?`j-message-loading ${s.contentClass}`:"j-message-loading"};return f.open({...s,...n})},destroy:()=>{u&&u.destroy()}};export{f as m};
